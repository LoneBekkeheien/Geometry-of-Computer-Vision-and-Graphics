function H = u2H(u,u0)

    H=[];
      for i=1:4
      M(i,1)=u(1,i);
      M(i,2)=u(2,i);
      M(i,3)=1;
      M(i,4)=0;
      M(i,5)=0;
      M(i,6)=0;
      M(i,7)=-u0(1,i)*u(1,i);
      M(i,8)=-u0(1,i)*u(2,i);
      M(i,9)=-u0(1,i);

      M(i+4, 1)=0;
      M(i+4, 2)=0;
      M(i+4, 3)=0;
      M(i+4, 4)=u(1,i);
      M(i+4, 5)=u(2,i);
      M(i+4, 6)=1;
      M(i+4, 7)=-u0(2,i)*u(1,i);
      M(i+4, 8)=-u0(2,i)*u(2,i);
      M(i+4, 9)=-u0(2,i);
  
  end 
  
  H1=null(M);
  H=reshape(H1,[3,3]).';
  H=(1/H(3,3))*H;
end